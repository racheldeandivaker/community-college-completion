---
title: "Top Five Certificates and Associate Degrees across FL Community Colleges"
author: "Rachel Dean Divaker"
date: "2025-10-14"
output: pdf_document
---
Install packages and load libraries
```{r setup, include=FALSE}
#install packages (only run once then comment out)
# install.packages('educationdata')

#load libraries

library(dplyr)
library(educationdata)


```

Importing and cleaning data from directory and program completions using CIP_6 codes. 2022 is the most recent year available. 

```{r}
# Import directory dataset
dir_data <- get_education_data(
  level = "college-university",
  source = "ipeds",
  topic = "directory",
  filters = list(year = 2022)
)



```

```{r}
#Import completions-cip-6 dataset

comp_data <- get_education_data(
  level = "college-university",
  source = "ipeds",
  topic = "completions-cip-6",
  filters = list(year = 2022)
)

```

Cleaning data:

```{r}
#directory

# Select and filter variables
clean_dir <- dir_data %>%
  select(unitid, year, fips, sector, inst_name) %>%
  filter(fips == 12, sector == 1, !is.na(inst_name))

```

```{r}
#CIP

# Select and filter variables
#fips: 12 is Florida 
#award_level: 1, 2, 30, 31, 32 = certificates
#award_level: 4 = associate degrees
#awards_6digit: above 0 - completer
#cipcode_6digit: above 0 - specific program name, removing 99 (it appears to include all programs/ miscellaneous category)

clean_comp <- comp_data %>%
  select(unitid, cipcode_6digit, award_level, awards_6digit, fips, year) %>%
  filter(fips == 12, cipcode_6digit > 0, cipcode_6digit != 99, award_level %in% c(1, 2, 4, 30, 31, 32, 33), awards_6digit > 0)

```

Merging Directory and CIPcode 
```{r}
#merging dataframes

merged_data <- left_join(clean_comp, clean_dir, by = c("unitid", "year", "fips"))


```

Top five Associate programs for each college:
```{r}
# Filter to Associate Degree programs (award_level = 4)
assoc_degrees <- merged_data %>%
  filter(award_level == 4)

# Get total awards per college + program
assoc_program_totals <- assoc_degrees %>%
  group_by(inst_name, cipcode_6digit) %>%
  summarise(total_awards = sum(awards_6digit, na.rm = TRUE), .groups = "drop")

# Top 5 Associate programs per college
top_5_assoc <- assoc_program_totals %>%
  group_by(inst_name) %>%
  slice_max(order_by = total_awards, n = 5, with_ties = TRUE) %>%
  arrange(inst_name, desc(total_awards))

# Results
print("Top 5 Associate Degree Programs by College:")
head(top_5_assoc, 20)



```

Get top five Certificate programs for each college
```{r}
# Filter to Certificate programs (award_levels 1, 2, 30, 31, 32, 33)- double check with Zyra on this variable.
certificates <- merged_data %>%
  filter(award_level %in% c(1, 2, 30, 31, 32, 33))

# Get total awards per college + program
cert_program_totals <- certificates %>%
  group_by(inst_name, cipcode_6digit) %>%
  summarise(total_awards = sum(awards_6digit, na.rm = TRUE), .groups = "drop")

# Top 5 Certificate programs per college
top_5_certs <- cert_program_totals %>%
  group_by(inst_name) %>%
  slice_max(order_by = total_awards, n = 5, with_ties = TRUE) %>%
  arrange(inst_name, desc(total_awards))

# Results
print("Top 5 Certificate Programs by College:")
head(top_5_certs, 20)

```
